{"version":3,"sources":["../../../../freecodecamp/danmu/scripts/danmu.js"],"names":["$","document","ready","ref","Wilddog","arr","click","text","val","child","push","keypress","event","keyCode","trigger","remove","empty","on","snapshot","textObj","append","moveObj","topMin","offset","top","topMax","height","_top","obj","_left","width","css","left","color","getRandomColor","time","Math","random","animate","h","Array","length","join","toString","getAndRun","n","floor","setTimeout","jQuery","fx","interval"],"mappings":";;AAAA;;;AAGAA,EAAEC,QAAF,EAAYC,KAAZ,CAAkB,YAAW;AACzB;AACA;AACA,QAAIC,MAAM,IAAIC,OAAJ,CAAY,sCAAZ,CAAV;AACA,QAAIC,MAAM,EAAV;AACA;AACAL,MAAE,QAAF,EAAYM,KAAZ,CAAkB,YAAW;AACzB,YAAIC,OAAOP,EAAE,QAAF,EAAYQ,GAAZ,EAAX;AACAL,YAAIM,KAAJ,CAAU,SAAV,EAAqBC,IAArB,CAA0BH,IAA1B;AACAP,UAAE,QAAF,EAAYQ,GAAZ,CAAgB,EAAhB;AACH,KAJD;AAKA;AACAR,MAAE,QAAF,EAAYW,QAAZ,CAAqB,UAASC,KAAT,EAAgB;AACjC,YAAIA,MAAMC,OAAN,IAAiB,IAArB,EAA2B;AACvBb,cAAE,QAAF,EAAYc,OAAZ,CAAoB,OAApB;AACH;AACJ,KAJD;AAKA;AACAd,MAAE,QAAF,EAAYM,KAAZ,CAAkB,YAAW;AACzBH,YAAIY,MAAJ;AACAV,cAAM,EAAN;AACAL,UAAE,UAAF,EAAcgB,KAAd;AACH,KAJD;AAKA;AACAb,QAAIM,KAAJ,CAAU,SAAV,EAAqBQ,EAArB,CAAwB,aAAxB,EAAuC,UAASC,QAAT,EAAmB;AACtD,YAAIX,OAAOW,SAASV,GAAT,EAAX;AACAH,YAAIK,IAAJ,CAASH,IAAT;AACA,YAAIY,UAAUnB,EAAE,kCAAF,CAAd;AACAmB,gBAAQZ,IAAR,CAAaA,IAAb;AACAP,UAAE,UAAF,EAAcoB,MAAd,CAAqBD,OAArB;AACAE,gBAAQF,OAAR;AACH,KAPD;;AASAhB,QAAIc,EAAJ,CAAO,eAAP,EAAwB,YAAW;AAC/BZ,cAAM,EAAN;AACAL,UAAE,UAAF,EAAcgB,KAAd;AACH,KAHD;AAIA;AACA,QAAIM,SAAStB,EAAE,UAAF,EAAcuB,MAAd,GAAuBC,GAApC;AACA,QAAIC,SAASH,SAAStB,EAAE,UAAF,EAAc0B,MAAd,EAAtB;AACA,QAAIC,OAAOL,MAAX;;AAEA,QAAID,UAAU,SAAVA,OAAU,CAASO,GAAT,EAAc;AACxB,YAAIC,QAAQ7B,EAAE,UAAF,EAAc8B,KAAd,KAAwBF,IAAIE,KAAJ,EAApC;AACAH,eAAOA,OAAO,EAAd;AACA,YAAIA,OAAQF,SAAS,EAArB,EAA0B;AACtBE,mBAAOL,MAAP;AACH;AACDM,YAAIG,GAAJ,CAAQ;AACJC,kBAAMH,KADF;AAEJL,iBAAKG,IAFD;AAGJM,mBAAOC;AAHH,SAAR;AAKA,YAAIC,OAAO,QAAQ,QAAQC,KAAKC,MAAL,EAA3B;AACAT,YAAIU,OAAJ,CAAY;AACRN,kBAAM,MAAMH,KAAN,GAAc;AADZ,SAAZ,EAEGM,IAFH,EAES,YAAW;AAChBP,gBAAIb,MAAJ;AACH,SAJD;AAKH,KAjBD;;AAmBA,QAAImB,iBAAiB,SAAjBA,cAAiB,GAAW;AAC5B,eAAO,MAAO,UAASK,CAAT,EAAY;AAClB,mBAAO,IAAIC,KAAJ,CAAU,IAAID,EAAEE,MAAhB,EAAwBC,IAAxB,CAA6B,GAA7B,IAAoCH,CAA3C;AACH,SAFQ,CAEN,CAACH,KAAKC,MAAL,KAAgB,SAAhB,IAA6B,CAA9B,EAAiCM,QAAjC,CAA0C,EAA1C,CAFM,CAAb;AAGH,KAJD;;AAMA,QAAIC,YAAY,SAAZA,SAAY,GAAW;AACvB,YAAIvC,IAAIoC,MAAJ,GAAa,CAAjB,EAAoB;AAChB,gBAAII,IAAIT,KAAKU,KAAL,CAAWV,KAAKC,MAAL,KAAgBhC,IAAIoC,MAApB,GAA6B,CAAxC,IAA6C,CAArD;AACA,gBAAItB,UAAUnB,EAAE,UAAUK,IAAIwC,CAAJ,CAAV,GAAmB,QAArB,CAAd;AACA7C,cAAE,UAAF,EAAcoB,MAAd,CAAqBD,OAArB;AACAE,oBAAQF,OAAR;AACH;;AAED4B,mBAAWH,SAAX,EAAsB,IAAtB;AACH,KATD;;AAWAI,WAAOC,EAAP,CAAUC,QAAV,GAAqB,EAArB;AACAN;AACH,CAhFD","file":"danmu.js","sourcesContent":["/**\r\n * Created by ZHQ on 2017/7/17.\r\n */\r\n$(document).ready(function() {\r\n    //提示：已经在页面导航部分的Settings中的JavaScript部分引入了wildog.js和jquery.js\r\n    //在www.wildog.com 注册一个账号，创建一个应用，自动生成一个url,替换下边url即可\r\n    var ref = new Wilddog(\"https://danwu.wilddogio.com/messages\");\r\n    var arr = [];\r\n    //把数据提交到野狗云\r\n    $(\".s_sub\").click(function() {\r\n        var text = $(\".s_txt\").val();\r\n        ref.child('message').push(text);\r\n        $(\".s_txt\").val('');\r\n    });\r\n    //响应按键点击事件\r\n    $(\".s_txt\").keypress(function(event) {\r\n        if (event.keyCode == \"13\") {\r\n            $(\".s_sub\").trigger('click');\r\n        }\r\n    });\r\n    //响应按键清除事件\r\n    $(\".s_del\").click(function() {\r\n        ref.remove();\r\n        arr = [];\r\n        $('.dm_show').empty();\r\n    });\r\n    //监听云端数据变更，云端数据变化，弹幕框里数据也跟着变化。\r\n    ref.child('message').on('child_added', function(snapshot) {\r\n        var text = snapshot.val();\r\n        arr.push(text);\r\n        var textObj = $(\"<div class=\\\"dm_message\\\"></div>\");\r\n        textObj.text(text);\r\n        $(\".dm_show\").append(textObj);\r\n        moveObj(textObj);\r\n    });\r\n\r\n    ref.on('child_removed', function() {\r\n        arr = [];\r\n        $('.dm_show').empty();\r\n    });\r\n    //按照时间规则显示弹幕内容。\r\n    var topMin = $('.dm_mask').offset().top;\r\n    var topMax = topMin + $('.dm_mask').height();\r\n    var _top = topMin;\r\n\r\n    var moveObj = function(obj) {\r\n        var _left = $('.dm_mask').width() - obj.width();\r\n        _top = _top + 50;\r\n        if (_top > (topMax - 50)) {\r\n            _top = topMin;\r\n        }\r\n        obj.css({\r\n            left: _left,\r\n            top: _top,\r\n            color: getRandomColor()\r\n        });\r\n        var time = 20000 + 10000 * Math.random();\r\n        obj.animate({\r\n            left: \"-\" + _left + \"px\"\r\n        }, time, function() {\r\n            obj.remove();\r\n        });\r\n    }\r\n\r\n    var getRandomColor = function() {\r\n        return '#' + (function(h) {\r\n                return new Array(7 - h.length).join(\"0\") + h\r\n            })((Math.random() * 0x1000000 << 0).toString(16))\r\n    }\r\n\r\n    var getAndRun = function() {\r\n        if (arr.length > 0) {\r\n            var n = Math.floor(Math.random() * arr.length + 1) - 1;\r\n            var textObj = $(\"<div>\" + arr[n] + \"</div>\");\r\n            $(\".dm_show\").append(textObj);\r\n            moveObj(textObj);\r\n        }\r\n\r\n        setTimeout(getAndRun, 3000);\r\n    }\r\n\r\n    jQuery.fx.interval = 50;\r\n    getAndRun();\r\n});"]}